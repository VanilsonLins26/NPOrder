

<div class="surface-ground px-4 py-5 md:px-6 lg:px-8 min-h-screen">
    
    <div class="text-900 font-bold text-4xl mb-4 brand-font" style="color: var(--padaria-brown);">
        <i class="pi pi-shopping-cart text-4xl mr-2"></i> Seu Carrinho
    </div>

    <div *ngIf="!cart?.cartItems?.length" class="surface-card p-5 shadow-2 border-round text-center">
        <div class="text-900 font-bold text-2xl mb-3">Seu carrinho est√° vazio üòî</div>
        <p class="text-700 mb-4">Que tal adicionar algumas del√≠cias?</p>
        <p-button label="Ver Card√°pio" icon="pi pi-arrow-left" [routerLink]="['/cardapio']"></p-button>
    </div>

    <div *ngIf="cart?.cartItems?.length" class="grid">
        
        <div class="col-12 lg:col-8">
            <div class="surface-card shadow-2 border-round p-3">
                <p-table [value]="cart!.cartItems" responsiveLayout="stack" [breakpoint]="'768px'">
                    <ng-template pTemplate="header">
                        <tr>
                            <th>Produto</th>
                            <th>Pre√ßo</th>
                            <th>Qtd</th>
                            <th>Subtotal</th>
                            <th></th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-item>
                        <tr>
                            <td>
                                <div class="flex align-items-center gap-3">
                                    <img [src]="item.product.imageUrl || 'assets/images/logo-padaria.png'" 
                                         style="width: 60px; height: 60px; object-fit: cover; border-radius: 6px;">
                                    <div>
                                        <span class="font-bold block text-900">{{ item.product.name }}</span>
                                        <span class="text-sm text-500" *ngIf="item.comment">
                                            Obs: {{ item.comment }}
                                        </span>
                                    </div>
                                </div>
                            </td>
                            
                            <td>
                                <span class="p-column-title font-bold">Pre√ßo</span>
                                {{ item.unityPrice | currency:'BRL' }}
                            </td>
                            
                            <td>
                                <span class="p-column-title font-bold">Qtd</span>
                                <p-inputNumber [(ngModel)]="item.quantity" 
                                               [showButtons]="true" 
                                               buttonLayout="horizontal" 
                                               inputId="horizontal"
                                               [min]="1"
                                               [step]="1"
                                               inputStyleClass="w-3rem text-center"
                                               decrementButtonClass="p-button-text p-button-secondary" 
                                               incrementButtonClass="p-button-text p-button-secondary" 
                                               incrementButtonIcon="pi pi-plus" 
                                               decrementButtonIcon="pi pi-minus"
                                               (onInput)="updateQuantity(item, $event.value || 1)">
                                </p-inputNumber>
                            </td>

                            <td class="font-bold text-900">
                                <span class="p-column-title font-bold">Total</span>
                                {{ item.totalPrice | currency:'BRL' }}
                            </td>

                            <td>
                                <p-button icon="pi pi-trash" 
                                          styleClass="p-button-rounded p-button-danger p-button-text" 
                                          (onClick)="removeItem(item.product.id)">
                                </p-button>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>

                <div class="flex justify-content-end mt-3">
                    <p-button label="Limpar Carrinho" 
                              icon="pi pi-trash" 
                              styleClass="p-button-text p-button-danger p-button-sm" 
                              (onClick)="clearCart()">
                    </p-button>
                </div>
            </div>
        </div>

        <div class="col-12 lg:col-4">
            <div class="surface-card shadow-2 border-round p-4 sticky top-0" style="top: 20px;">
                <div class="text-900 font-bold text-2xl mb-3">Resumo</div>
                
                <div class="flex justify-content-between mb-3">
                    <span class="text-700">Subtotal</span>
                    <span class="text-900">{{ cart!.total | currency:'BRL' }}</span>
                </div>
                
                <div class="border-top-1 surface-border my-3"></div>
                
                <div class="flex justify-content-between mb-4">
                    <span class="text-900 font-bold text-xl">Total</span>
                    <span class="text-900 font-bold text-xl" style="color: var(--padaria-brown);">
                        {{ cart!.total | currency:'BRL' }}
                    </span>
                </div>

                <p-button label="Finalizar Pedido" 
                          icon="pi pi-check" 
                          styleClass="w-full p-button-lg" 
                          (onClick)="checkout()">
                </p-button>
                
                <p-button label="Continuar Comprando" 
                          styleClass="w-full mt-3 p-button-outlined p-button-secondary" 
                          [routerLink]="['/cardapio']">
                </p-button>
            </div>
        </div>

    </div>
</div>